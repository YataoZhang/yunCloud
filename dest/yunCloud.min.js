/*! yunCloud 2016-04-21 */
!function(a){"use strict";var b=b,c=this;if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var d;d="undefined"!=typeof window?window:void 0!==typeof b?b:c,d.yunCloud=a()}}(function(){"use strict";var a={"&lt;":"<","&gt;":">","&nbsp;":" ","&quot;":'"',"&amp;":"&"},b={"&":"&amp;","<":"&lt;",">":"&gt;"," ":"&nbsp;",'"':"&quot;"},c=function(){this.map={}};c.prototype.set=function(a,b,c){return(this.map[a]||(this.map[a]={}))[b]=c},c.prototype.get=function(a){return this.map[a]||{}};var d={noop:function(a){return a||""},forIn:function(a,b){for(var c in a)a.hasOwnProperty(c)&&b.call(null,c,a[c])},extend:function(a,b){this.forIn(a,function(c){var d=b[c];a[c]=void 0===d?a[c]:d})},trim:function(a){return"".trim?(""+a).trim():a.replace(/^\s+|\s+$/g,"")}},e={matchReg:/^([\S\s]+?)(|\|([\S\s]+))$/,convert:/<%-([\S\s]+?)%>/g,val:/<%&([\S\s]+?)%>/g,origin:/<%=([\S\s]+?)%>/g,expression:/<%([\s\S]+?)%>/g},f={loose:!0,cache:!0,strip:!0},g=function(){this.cacheList=new c,this.event={}};g.prototype={constructor:g,render:function(a){var b=this,c="";f.loose&&(c="data.");var g="";f.strip?g=a.replace(/\s/g," "):(g=a.replace(/\n/g,"\\n"),g=g.replace(/\r/g,"\\r"),g=g.replace(/\f/g,"\\f"),g=g.replace(/\t/g,"\\t"),g=g.replace(/\v/g,"\\v")),g=g.replace(/\'/g,"\\'"),e.convert.test(a)&&(g=g.replace(e.convert,function(a,b){return'\' + transfer("encode",'+c+b+'||"") + \''})),e.val.test(a)&&(g=g.replace(e.val,function(a,b){return"'+ "+b+"+'"})),e.origin.test(a)&&(g=g.replace(e.origin,function(a,f){if(f=c+f,/\|/.test(f=d.trim(f))){var g=f.match(e.matchReg);return"'+ ("+(b.event[d.trim(g[3])]||d.noop).toString()+")("+g[1]+") +'"}return"'+("+f+'||"")+\''})),e.expression.test(a)&&(g=g.replace(e.expression,function(a,b){return"');\n"+b+"\ntpl.push('"})),g=g.replace(/'\n/g,"'").replace(/\n\'/gm,"'").replace(/\\(?!f|n|r|t|v)/g,"\\\\"),g="tpl.push('"+g+"');",g=g.replace(/tpl\.push\((''|'[\\n\s]+)'\);/g,"");var h="";return f.loose?(g="var tpl=[];"+g+"\nreturn tpl.join('');",h="data"):(g="var tpl=[];\nwith(obj||{}){\n"+g+"\n}\nreturn tpl.join('');",h="obj"),new Function(h,"transfer",g)},storageCache:function(a){var b=this,c=this.cacheList.get(a.length)[a];return c?c:(c=this.render(a),this.cacheList.set(a.length,a,function(a){return c(a,b.transfer)}))},transfer:function(c,e){var f=function(a,b){e=e.replace(new RegExp(a,"g"),b)};return"encode"===c?d.forIn(b,f):d.forIn(a,f),e}},g.obtain=new g;var h={template:function(a){return f.cache?g.obtain.storageCache(a):function(b){return g.obtain.render(a)(b,g.obtain.transfer)}}},i=function(a,b){return 1===arguments.length?h.template(a):h.template(a)(b)};return i.register=function(a,b){g.obtain.event[a]=b},i.unRegister=function(a){delete g.obtain.event[a]},i.set=function(a){d.extend(f,a)},i});